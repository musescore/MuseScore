# Developing MuseScore with Gemini CLI in Antigravity

This guide explains how to use **Gemini CLI** within the **Antigravity** IDE to assist with developing MuseScore. Gemini CLI can help you understand the codebase, find bugs, write code, and generate tests.

## 1. Setup

The Gemini CLI is integrated into the Antigravity IDE.

1.  **Automatic Nudge**: When you first open the terminal in Antigravity, you may be prompted to connect Gemini CLI. Select "Yes" to enable it.
2.  **Manual Check**: You can verify the installation by running `gemini --version` in the terminal.

## 2. Basic Commands

Here are the essential commands for using Gemini CLI:

*   **`gemini chat`**: Start an interactive chat session with Gemini. You can ask general questions or specific questions about the codebase.
    *   *Example*: `gemini chat "How does MuseScore handle soundfont downloads?"`
*   **`gemini explain <file>`**: Ask Gemini to explain what a specific file does.
    *   *Example*: `gemini explain buildscripts/cmake/DownloadSoundFont.cmake`
*   **`gemini code "<instruction>"`**: Ask Gemini to generate code based on your instruction.
    *   *Example*: `gemini code "Write a CMake function to check file download status"`
*   **`gemini debug`**: Ask Gemini to help debug a specific issue or error message.

## 3. Workflow Example: Fixing a Bug

Here is a walkthrough of how you might use Gemini CLI to find and fix a bug, using a real example from the MuseScore codebase.

### Step 1: Find a Bug or Task

You want to contribute but don't know where to start. You can search for "TODO" comments in the code.

```bash
grep -r "TODO" buildscripts/
```

You find this TODO in `buildscripts/cmake/DownloadSoundFont.cmake`:
`## TODO check STATUS of downloads`

### Step 2: Understand the Code

Use Gemini to explain the file and the TODO.

**User**:
`gemini explain buildscripts/cmake/DownloadSoundFont.cmake`

**Gemini**:
> This CMake script handles the downloading of the MuseScore soundfont (MS Basic). It checks the remote version against the local version. If the remote version is newer, it downloads the `.sf3` file and associated metadata (License, Changelog, Readme). Currently, it only checks the download status of the main `.sf3` file, but not the metadata files.

### Step 3: Implement the Fix

Ask Gemini to help you write the missing checks.

**User**:
`gemini code "Update buildscripts/cmake/DownloadSoundFont.cmake to check the status of the License, Changelog, and Readme downloads. Log a WARNING if they fail."`

**Gemini** (generates code similar to):

```cmake
    file(DOWNLOAD "${DOWNLOAD_URL_ROOT}/MS_Basic_License.md" "${SOUND_DIRECTORY}/MS Basic_License.md" STATUS SF_LICENSE_DL_STATUS)
    list(GET SF_LICENSE_DL_STATUS 0 LICENSE_HTTP_STATUS)
    if (NOT LICENSE_HTTP_STATUS EQUAL 0)
      list(GET SF_LICENSE_DL_STATUS 1 LICENSE_HTTP_STATUS_TEXT)
      message(WARNING "Cannot download soundfont license. Error: ${LICENSE_HTTP_STATUS_TEXT}")
    endif()
    # ... (similar blocks for Changelog and Readme)
```

### Step 4: Apply and Verify

1.  Copy the code generated by Gemini.
2.  Paste it into the file `buildscripts/cmake/DownloadSoundFont.cmake`.
3.  Verify the changes by reading the file or running a diff.

## 4. Tips for Beginners

*   **Be Specific**: When asking Gemini to write code, be as specific as possible about variable names, error handling (e.g., "use WARNING, not FATAL_ERROR"), and file paths.
*   **Iterate**: If the first answer isn't perfect, ask follow-up questions or ask Gemini to refine the code.
*   **Review**: Always review the code Gemini generates. You are responsible for the final code committed to the repository.
